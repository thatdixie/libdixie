#!/bin/sh
######################################
# build libdixie.a
# -----------------
# This scripts adds generates build.h 
# DixieApp NameValue and Properties
# Objects to Libdixie.a
#######################################
#
version="libdixie Version 1.0"
b="build.h"
serial=$(date +%y%m%d%H%M%S)
script=$0

if [ -f $b ]; then
    rm $b
fi
echo "Creating configuration and new "$b"..."

echo "/*" >> $b
echo " * Auto-generated by "$script" on "`date` >> $b
echo " */"  >> $b
echo "#ifndef BUILD_H" >> $b
echo "#define BUILD_H" >> $b
echo "static const string VERSION =\""$version"\";" >> $b
echo "static const string SERIAL  =\""$serial"\";"  >> $b
echo "#endif" >> $b
 
if g++ -I$HOME/include -I. NameValue.cpp Properties.cpp DixieApp.cpp -c; then
    echo "DixieApp NameValue and Properties Objects created..."
    if ar cr $HOME/lib/libdixie.a NameValue.o Properties.o DixieApp.o; then
        echo "DixieApp.o NameValue.o and Properties.o added to $HOME/lib/libdixie.a library..."
        if g++  test.cpp -I$HOME/include -I. -L$HOME/lib -ldixie -o test; then
            echo "Build complete -- run ./test to verify"
        else
            echo "***ERROR compiling test.cpp"
        fi
    else
        echo "***ERROR adding to library build terminated "
    fi
else
    echo "***ERRORS in compiling build terminated "
fi

 
